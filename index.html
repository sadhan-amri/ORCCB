<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Oregon Contractor Completion Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 40px;
    }

    .form-container {
      background: white;
      padding: 30px;
      max-width: 900px;
      margin: auto;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 1.2rem;
    }

    .declaration {
      padding: 15px;
      margin-bottom: 20px;
      font-size: 1rem;
      line-height: 1.5;
    }

    .form-row {
      display: flex;
      gap: 20px;
      margin-top: 15px;
    }

    .form-group {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    input, select {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 0.9rem;
      width: 100%;
      box-sizing: border-box;
    }

    input::placeholder {
      font-size: 0.85rem;
      color: #666;
    }

    /* Make email column wider on desktop */
    .form-row .form-group:nth-child(3) {
      flex: 2;
    }

    .language-options {
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 0.9rem;
    }

    .submit-button {
      background-color: #aac934;
      color: black;
      font-weight: bold;
      border: none;
      padding: 15px;
      width: 320px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      margin-top: 30px;
    }

    .submit-button:hover {
      background-color: #94ad2c;
    }

    /* Responsive stacking for mobile */
    @media (max-width: 900px) {
      .form-row {
        flex-direction: column;
      }
      .form-row .form-group {
        flex: 1 1 100%;
      }
      .form-row .form-group:nth-child(3) {
        flex: 1 1 100%; /* reset email column */
      }
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2>Completion Form</h2>

    <!-- Declaration -->
    <div class="declaration">
      I, 
      <input type="text" name="firstName" id="firstName" placeholder="First Name *" required>
      <input type="text" name="lastName" id="lastName" placeholder="Last Name *" required>,
      under penalty of perjury, declare that I studied the NASCLA Contractors Guide to Business, Law and Project Management, Oregon Construction Contractors, 2nd Edition for no fewer than 16 hours in total, allocating at least 69 minutes to each of the 14 chapters.
    </div>

    <form id="completionForm">

      <!-- Row 2: ID, Address, Email -->
      <div class="form-row">
        <div class="form-group">
          <input type="text" name="idNumber" id="idNumber" placeholder="Number on your photo ID *" required>
        </div>
        <div class="form-group">
          <input type="text" name="idAddress" id="idAddress" placeholder="Address on your photo ID *" required>
        </div>
        <div class="form-group">
          <input type="email" name="email" id="email" placeholder="Email *" required>
        </div>
      </div>

      <!-- Row 3: Language + Phone -->
      <div class="form-row">
        <div class="form-group">
          <label>Final Exam Language:</label>
          <div class="language-options">
            <label><input type="checkbox" name="language" value="English"> English</label>
            <label><input type="checkbox" name="language" value="Spanish"> Spanish</label>
          </div>
        </div>
        <div class="form-group">
          <input type="tel" name="phone" id="phone" placeholder="Phone Number *" required>
        </div>
      </div>

      <!-- Row 4: Date -->
      <div class="form-row">
        <div class="form-group">
          <input type="date" name="date" id="date" required>
        </div>
      </div>

      <!-- Row 5: Submit -->
      <button type="submit" class="submit-button">Submit</button>
    </form>
  </div>

  <script>
    document.getElementById('completionForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const data = new FormData(this);
      const payload = {
        firstName: data.get('firstName'),
        lastName: data.get('lastName'),
        idNumber: data.get('idNumber'),
        idAddress: data.get('idAddress'),
        email: data.get('email'),
        phone: data.get('phone'),
        language: data.getAll('language'),
        date: data.get('date')
      };

      fetch("https://script.google.com/macros/s/AKfycbxUcZcZlWh-ZyYavictlhbbg3G3NoSCWhi_S6Q7avfKIzpd3U2R59U2ebPt9lOlRNA6/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      })
      .then(res => {
        if (!res.ok) throw new Error("Network response was not ok");
        return res.text();
      })
      .then(msg => {
        alert("Form submitted successfully!");
        document.getElementById('completionForm').reset();
      })
      .catch(err => {
        console.error("Submission error:", err);
        alert("Error submitting form: " + err.message);
      });
    });
  </script>
</body>
</html>
